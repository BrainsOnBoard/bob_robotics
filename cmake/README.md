## CMake
BoB robotics projects are built using [CMake](https://cmake.org). Note that the
minimum version required is 3.10, which is the default as of Ubuntu 18.04, but
is newer than the version included with Ubuntu 16.04. However, the CMake devs
[provide a PPA](https://apt.kitware.com) which includes prebuilt packages for
x86 and ARM64.

To make a new BoB robotics project you need to create a ``CMakeLists.txt`` file
with the following lines at the top:
```cmake
cmake_minimum_required(VERSION 3.10)
include([path to BoB robotics]/cmake/BoBRobotics.cmake)
```

Next, we find the BoB robotics package, specifying which modules we are using:
```cmake
find_package(BoBRobotics REQUIRED COMPONENTS hid antworld video)
```
As a rule of thumb, if you ``#include`` a file from a given folder, then the
folder name is the module you should include (i.e. if you include
[imgproc/opencv_unwrap_360.h](../include/imgproc/opencv_unwrap_360.h), you need
to add ``imgproc`` to your list of ``COMPONENTS``). Some modules depend on
others and on external libraries, but these dependencies should be handled
automatically.

Every subfolder in [third_party/](../third_party) counts as a third-party module
and there is a separate ``BoBThirdParty`` CMake package for these components.
[plog](https://github.com/SergiusTheBest/plog) is included automatically.
Header-only files do not need to be included with the exception of
[matplotlibcpp](../third_party/matplotlibcpp.h), which has external
dependencies:
```cmake
# Optionally specify third-party modules
find_package(BoBThirdParty REQUIRED COMPONENTS matplotlibcpp)
```

For more details, see the [example CMakeLists.txt file](example_CMakeLists.txt).
## Building projects
To build a project with CMake, use the standard procedure:
```sh
mkdir build
cd build
cmake ..
make -j $(nproc)
```

## Windows support
For Windows, we use [Microsoft's vcpkg](https://github.com/Microsoft/vcpkg) for
dependencies. To use with BoB robotics, install vcpkg following the instructions
[here](https://github.com/Microsoft/vcpkg/blob/master/README.md). As vcpkg
[installs 32-bit packages by default](https://github.com/Microsoft/vcpkg/issues/1254),
we recommend that you set the environment variable ``VCPKG_DEFAULT_TRIPLET`` to
``x64-windows`` to get 64-bit builds. You also need to set the environment
variable ``VCPKG_ROOT`` to wherever you have installed vcpkg, so that the BoB
robotics CMake file can find your installed packages.

You can then install any needed packages like so:
```bat
.\vcpkg.exe install opencv
```

Note that CMake *also* defaults to building 32-bit binaries on Windows; if you
want a 64-bit build you have to enable it explicitly:
```bat
cmake.exe -DCMAKE_GENERATOR_PLATFORM=x64 ..
```

You may need to set your build type in Visual Studio to ``Release`` as sometimes
debug versions of DLLs appear not to be generated by vcpkg.
